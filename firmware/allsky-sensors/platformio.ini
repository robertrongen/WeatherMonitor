[env:heltec_wifi_lora_32_V2]
platform = espressif32
board = heltec_wifi_lora_32_V2
framework = arduino
board_build.f_cpu = 240000000L
board_build.flash_mode = dio
board_build.flash_size = 4MB
board_build.flash_freq = 80m

; Serial Monitor Configuration
monitor_speed = 115200
monitor_port = auto
monitor_filters = esp32_exception_decoder

; Upload Configuration
upload_speed = 921600
upload_port = auto

; Build Configuration
build_flags =
    -D ARDUINO_ARCH_ESP32
    -D CONFIG_ARDUINO_LOOP_STACK_SIZE=32768
    -D CORE_DEBUG_LEVEL=ARDUHAL_LOG_LEVEL_INFO
    -D HELTEC_BOARD=1
    -D ARDUINO_HELTEC_WIFI_LORA_32_V2
    ; Region and radio config are in src/lmic_project_config.h
    ; Resolve hal_init conflict: Allow multiple definitions (LMIC's hal_init takes precedence)
    -Wl,--allow-multiple-definition

; Exclude problematiclibpp from ESP32 core to avoid conflict
build_unflags =
    -lpp

; PlatformIO Library Dependencies
lib_deps =
    ; MCCI LMIC 3.3.0: Stable version without hal_init conflict
    ; EU868 and SX1276 configured in src/lmic_project_config.h
    mcci-catena/MCCI LoRaWAN LMIC library@^3.3.0
    ; OLED Display Library (SSD1306)
    thingpulse/ESP8266 and ESP32 OLED driver for SSD1306 displays@^4.4.0
    ; Sensor Libraries
    adafruit/Adafruit MLX90614 Library@^2.1.3
    adafruit/Adafruit TSL2591 Library@^1.4.1
    adafruit/Adafruit Unified Sensor@^1.1.14

; Additional PlatformIO Options
board_build.partitions = default_4mb.csv
board_build.board = heltec_wifi_lora_32_V2
board_build.mcu = esp32
board_build.core = esp32
board_build.variant = esp32
board_build.psram_size = 0